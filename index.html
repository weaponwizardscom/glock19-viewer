<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Weapon-Wizards – Konfigurator</title>

<style>
@font-face{font-family:'Eurostile';font-weight:900;font-style:normal;src:local('Eurostile Extended Black'),local('Eurostile');}
:root{--page:#000;--box:#000;--txt:#fff;--border:#dee2e6;--pri:#007bff;--track:#555;--thumb:#007bff;}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;background:var(--page);display:flex;justify-content:center;padding:20px}

/* ========== układ bazowy (BEZ zmian) ================================ */
.configurator{background:var(--box);border-radius:8px;box-shadow:0 8px 24px #0008;display:flex;flex-wrap:wrap;gap:24px;max-width:1200px;width:100%;padding:24px;}
.controls,.summary,#reset-btn,#price,#send-btn{order:0}
/* … (cały niezmieniony styling z poprzedniej bazy) … */

/* --- PALETA --------------------------------------------------------- */
.palette-wrap{max-height:400px;overflow:auto;padding-right:0;position:relative}
@media(max-width:768px){ .palette-wrap{overflow:hidden} }   /* mobile – ukrywamy natywne */

/* Suwak DIV – widoczny tylko mobile */
#slider-track{display:none}
@media(max-width:768px){
  #slider-track{
    display:block;position:absolute;top:0;right:4px;width:28px;height:100%;
    background:var(--track);border-radius:14px;touch-action:none;
  }
  #slider-thumb{
    position:absolute;top:0;left:0;width:28px;height:120px;background:var(--thumb);border-radius:14px;cursor:pointer;
  }
}
</style>
</head>

<body>
<!-- ========== HTML oryginału (skrócone, nic nie zmieniam) ========== -->
<div class="configurator">
  <!-- gun-wrap …,  controls …, wszystko tak jak w bazie po zmianie kolejności -->
  <!-- … -->
  <div class="section">
    <div class="sec-hdr"><h3 id="h-col">2. Wybierz kolor (Cerakote)</h3></div>
    <div class="palette-wrap">
      <div id="palette" class="palette"></div>

      <!-- NOWY slider (Tylko mobile) -->
      <div id="slider-track">
        <div id="slider-thumb"></div>
      </div>
    </div>
  </div>
  <!-- … -->
</div>

<script src="app.js"></script>

<script>
document.addEventListener('DOMContentLoaded',()=>{

/* ---- zachowujemy wcześniejsze reorder()  -------------------------- */
const mq = window.matchMedia('(max-width:768px)');
const wrap=document.querySelector('.gun-wrap'), ctrl=document.querySelector('.controls'), sum=document.querySelector('.summary');
function reorder(){ mq.matches ? wrap.insertBefore(ctrl,sum) : document.querySelector('.configurator').appendChild(ctrl); }
mq.addEventListener ? mq.addEventListener('change',reorder):mq.addListener(reorder); reorder();

/* ---- CUSTOM SLIDER ------------------------------------------------- */
const palette = document.getElementById('palette');
const track   = document.getElementById('slider-track');
const thumb   = document.getElementById('slider-thumb');

function updateThumb(){                      /* scroll → thumb */
  const maxScroll = palette.scrollHeight - palette.clientHeight;
  const ratio     = palette.scrollTop / maxScroll || 0;
  const maxPos    = track.clientHeight - thumb.clientHeight;
  thumb.style.top = (ratio * maxPos) + 'px';
}

function setMaxAndSync(){
  if(mq.matches){          /* tylko gdy mobile */
    updateThumb();
  }
}

/* thumb drag → scroll */
let startY, startScroll;
thumb.addEventListener('pointerdown', e=>{
  e.preventDefault(); thumb.setPointerCapture(e.pointerId);
  startY = e.clientY; startScroll = palette.scrollTop;
});
thumb.addEventListener('pointermove', e=>{
  if(startY===undefined) return;
  const dy = e.clientY - startY;
  const maxScroll = palette.scrollHeight - palette.clientHeight;
  const maxPos    = track.clientHeight - thumb.clientHeight;
  const newPos    = Math.min(Math.max(0, (startScroll/maxScroll*maxPos) + dy), maxPos);
  palette.scrollTop = newPos / maxPos * maxScroll;
});
thumb.addEventListener('pointerup',   ()=>{ startY=undefined; });

/* scroll wewnętrzny → przesuwamy thumb */
palette.addEventListener('scroll', updateThumb);

/* klik (tap) w tor → skok */
track.addEventListener('pointerdown', e=>{
  if(e.target!==track) return;
  const rect=track.getBoundingClientRect();
  const clickY=e.clientY-rect.top-thumb.clientHeight/2;
  const maxPos=track.clientHeight-thumb.clientHeight;
  const pos   = Math.max(0,Math.min(clickY,maxPos));
  const ratio = pos/maxPos;
  palette.scrollTop = ratio*(palette.scrollHeight-palette.clientHeight);
});

/* pobierz wysokość po wygenerowaniu kolorów */
setTimeout(setMaxAndSync,200);
window.addEventListener('resize',setMaxAndSync);

});
</script>
</body>
</html>
